## 並行プログラミング入門 7章

### 概要
様々な同期の手法及びその実装の紹介

### ノート
- Rustでの実装部分まではあまり興味を持てなかったので、概要のみを読んだ
- 公平な排他制御
  - チケットロック・MCSロックなどが紹介されている
  - コアなアイディアとしては、書き込み及び読み込みの競合（コンテンション）する箇所を減らすというもので、そのために変数を分離したりしている
- ソフトウェアトランザクショナルメモリ（STM）
  - いわゆるデータベース的な同期と似ていて、ロックを取得してから操作をするのではなく、操作をした後に競合していないかを判定し、競合していたらリトライする
  - ハードウェアレイヤのものとソフトウェアレイヤのものがあるらしい
    - [HaskellのSTM](https://ja.wikibooks.org/wiki/Haskell/Concurrency)
- ロックフリー
  - 一切同期をとらないという意味ではない
  - CASなどを用いて、「ロックがとれた=データの更新ができた」、「ロックがとれなかった=誰かがデータを更新した」というようにすることで、絶え間なく状態が更新されている状態を指していそう
  - ABA問題と呼ばれる、use-after-freeのような問題が起きうる
    - LL/SC命令を用いたり、ポインタにタグを用いたりして回避できる
    - CASだとswapするための値を作るために一度loadする必要があるので、その間に状態が更新されると困ることから、LL/SCでそれを防ぐ
      - Rust実装を見るとインラインアセンブリを埋め込んでいて大変そう
